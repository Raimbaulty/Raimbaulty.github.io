---
layout: mypost
title: åä¸ºäº‘éƒ¨ç½² MoonTV
date: 2025-08-16
published: true
categories: è‡ªéƒ¨ç½²
tags: 
 - linux
---

## å‡†å¤‡å·¥ä½œ

 [ç‚¹å‡»å‰å¾€](https://console.huaweicloud.com/iam/?region=cn-south-1#/mine/accessKey)ï¼Œç‚¹å‡» **æ–°å¢è®¿é—®å¯†é’¥**  åˆ›å»ºå¹¶ä¿å­˜å¯†é’¥ï¼Œå¯†é’¥åˆ›å»ºåæ— æ³•å†æ¬¡æŸ¥çœ‹è¯·å¦¥å–„ä¿å­˜

 [ç‚¹å‡»å‰å¾€](https://console.huaweicloud.com/swr/?region=cn-south-1#/swr/organization)ï¼Œç‚¹å‡» **åˆ›å»ºç»„ç»‡**ï¼Œè¾“å…¥ç»„ç»‡åç§°ååˆ›å»ºï¼Œæ³¨æ„è®°ä½ç»„ç»‡åç§°åé¢å°†ä¼šç”¨åˆ°

**æ³¨æ„**ï¼šé»˜è®¤ä½¿ç”¨çš„åœ°åŒºæ˜¯ åå—-å¹¿å·ï¼ˆcn-south-1ï¼‰ï¼Œå¯åœ¨å·¦ä¸Šè§’ç‚¹å‡»åˆ‡æ¢æœ€è¿‘çš„åœ°åŒº



## é•œåƒåŒæ­¥

[ç‚¹å‡»Forkä»“åº“](https://github.com/lomtom/sync-images/fork)ï¼Œè¿›å…¥ Fork åçš„ä»“åº“ä¾æ¬¡ç‚¹å‡» `Settings` â†’ `Secrets and variables` â†’ `Actions`  åˆ†åˆ«æ·»åŠ  Secrets å’Œ Variables

| åç§°              | ç±»å‹     | æè¿°           | ç¤ºä¾‹å€¼       |
| ----------------- | -------- | -------------- | ------------ |
| `ACCESSKEY`       | Secret   | åä¸ºäº‘ AK å¯†é’¥ | â€”            |
| `SECRETACCESSKEY` | Secret   | åä¸ºäº‘ SK å¯†é’¥ | â€”            |
| `IMAGE_REGION`    | Variable | åŒºåŸŸ           | `cn-south-1` |
| `IMAGE_GROUP`     | Variable | ç»„ç»‡å         | `sync`       |

æ·»åŠ å®Œæˆåï¼Œæœ‰ä¸¤ç§æ–¹æ³•åŒæ­¥

#### æ–¹æ³•ä¸€ï¼šä¿®æ”¹æ–‡ä»¶

åœ¨ Fork åçš„é¡¹ç›®æ ¹ç›®å½•æ‰¾åˆ° `images.txt`ï¼Œå†™å…¥éœ€è¦åŒæ­¥çš„é•œåƒï¼Œä¾‹å¦‚ï¼š

```txt
apache/kvrocks:latest
ghcr.io/moontechlab/lunatv:latest
```

æäº¤åˆ° `main` åˆ†æ”¯åï¼ŒGitHub Actions å°†è‡ªåŠ¨åŒæ­¥è‡³åä¸ºäº‘  

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨è§¦å‘

æ‰“å¼€ Fork åçš„ä»“åº“ï¼Œç‚¹å‡» `Actions` æ ‡ç­¾ï¼Œé€‰æ‹© **Sync Images â†’ Run workflow**  

è¾“å…¥é•œåƒåï¼Œå¦‚ `apache/kvrocks:latest`  åç‚¹å‡» **Run workflow**ï¼Œç­‰å¾…åŒæ­¥å®Œæˆ



## éƒ¨ç½² MoonTV

MoonTV æ”¯æŒçš„ç¯å¢ƒå˜é‡

| å˜é‡                                | è¯´æ˜               | å¯é€‰å€¼                | é»˜è®¤å€¼                      |
| ----------------------------------- | ------------------ | --------------------- | --------------------------- |
| `USERNAME`                          | ç®¡ç†å‘˜è´¦å·ï¼ˆå¿…å¡«ï¼‰ | ä»»æ„å­—ç¬¦ä¸²            | æ—                           |
| `PASSWORD`                          | ç®¡ç†å‘˜å¯†ç ï¼ˆå¿…å¡«ï¼‰ | ä»»æ„å­—ç¬¦ä¸²            | æ—                           |
| `NEXT_PUBLIC_SITE_NAME`             | ç«™ç‚¹åç§°           | ä»»æ„å­—ç¬¦ä¸²            | MoonTV                      |
| `ANNOUNCEMENT`                      | å…¬å‘Šä¿¡æ¯           | ä»»æ„å­—ç¬¦ä¸²            | æœ¬ç«™ä»…æä¾›å½±è§†ä¿¡æ¯æœç´¢æœåŠ¡â€¦ |
| `NEXT_PUBLIC_STORAGE_TYPE`          | æ’­æ”¾è®°å½•å­˜å‚¨æ–¹å¼   | redis/kvrocks/upstash | æ—                           |
| `KVROCKS_URL`                       | kvrocks è¿æ¥ URL   | url                   | ç©º                          |
| `REDIS_URL`                         | redis è¿æ¥ URL     | url                   | ç©º                          |
| `UPSTASH_URL`                       | upstash redis åœ°å€ | url                   | ç©º                          |
| `UPSTASH_TOKEN`                     | upstash token      | token                 | ç©º                          |
| `NEXT_PUBLIC_ENABLE_REGISTER`       | æ˜¯å¦å¼€æ”¾æ³¨å†Œ       | true/false            | false                       |
| `NEXT_PUBLIC_SEARCH_MAX_PAGE`       | æœ€å¤§æœç´¢é¡µæ•°é™åˆ¶   | 1-50                  | 5                           |
| `NEXT_PUBLIC_DOUBAN_PROXY_TYPE`     | è±†ç“£æ•°æ®ä»£ç†æ–¹å¼   | direct/proxy/custom   | direct                      |
| `NEXT_PUBLIC_DISABLE_YELLOW_FILTER` | å…³é—­æ•æ„Ÿå†…å®¹è¿‡æ»¤   | true/false            | false                       |

åœ¨æœåŠ¡å™¨ä¸Šæ–°å»º `docker-compose.yaml`ï¼Œç‰¹åˆ«æ³¨æ„ä¿®æ”¹ `image` çš„åœ°åŒºå’Œç»„ç»‡åç§°

```yaml
services:
  moontv-core:
    image: swr.cn-south-1.myhuaweicloud.com/sync/lunatv:latest
    container_name: moontv-core
    restart: unless-stopped
    ports:
      - '127.0.0.1:3000:3000'
    environment:
      - USERNAME=ç”¨æˆ·å
      - PASSWORD=å¯†ç 
      - NEXT_PUBLIC_STORAGE_TYPE=kvrocks
      - KVROCKS_URL=redis://moontv-kvrocks:6666
    networks:
      - moontv-network
    depends_on:
      - moontv-kvrocks

  moontv-kvrocks:
    image: swr.cn-south-1.myhuaweicloud.com/sync/kvrocks:latest
    container_name: moontv-kvrocks
    restart: unless-stopped
    volumes:
      - kvrocks-data:/var/lib/kvrocks
    networks:
      - moontv-network

networks:
  moontv-network:
    driver: bridge

volumes:
  kvrocks-data:
```

å…ˆåˆ‡æ¢åˆ°ç®¡ç†å‘˜

```bash
sudo -i
```

æ‹‰å–é•œåƒ

```bash
docker compose pull
```

é¦–æ¬¡ä½¿ç”¨éœ€æŒ‰æç¤ºç™»å½•åä¸ºäº‘ï¼Œæ‹‰å–å®Œæˆåå¯åŠ¨æœåŠ¡

```bash
docker compose up -d
```

è®¿é—®ç«™ç‚¹åœ°å€ï¼Œä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•åï¼Œå³ä¸Šè§’ç‚¹å‡» ğŸ‘¤è¿›å…¥ç®¡ç†é¢æ¿ï¼Œç‚¹å‡» **é…ç½®æ–‡ä»¶**ï¼Œè®¢é˜…URLè¾“å…¥ 

```tex
https://gist.githubusercontent.com/senshinya/5a5cb900dfa888fd61d767530f00fc48/raw/gistfile1.txt
```

ç‚¹å‡» **æ‹‰å–é…ç½®**ï¼Œæ‹‰å–æˆåŠŸåç‚¹å‡»ä¿å­˜ï¼Œå†ç‚¹å‡»å·¦ä¸Šè§’ **MoonTV** å›åˆ°ä¸»é¡µå¼€å§‹ä½¿ç”¨



## å‚è€ƒé“¾æ¥

- https://github.com/lomtom/sync-images  
- https://github.com/MoonTechLab/LunaTV  