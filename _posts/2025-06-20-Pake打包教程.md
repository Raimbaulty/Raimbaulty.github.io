---
layout: mypost
title: Pake打包教程
date: 2025-06-20
published: true
categories: 笔记
tags: 
 - linux
---

# Pake打包教程

## 安装NVM安装 NVM

1. 安装 NVM

    ```bash
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
    ```

    执行后，重启终端或运行：

    ```bash
    source ~/.bashrc
    ```

2. 查看可用 Node 版本

    ```bash
    nvm ls-remote
    ```

3. 安装并使用指定版本

    ```bash
    nvm install 18       # 安装最新 18.x
    nvm use 18           # 切换到 18.x
    ```
    
4. 设置默认版本

    ```bash
    nvm alias default 18
    ```

5. 查看已安装版本

    ```bash
    nvm ls
    ```

6. 启用 Corepack（管理 pnpm）
   Node.js 16.10+ 自带 Corepack，用它来“全局”管理 pnpm 而不是 `npm -g`

    ```bash
    corepack enable
    corepack prepare pnpm@latest --activate
    ```

    执行后你就可以在终端直接用 `pnpm` 了

## Pake打包

1. 安装依赖

   ```bash
   sudo apt update
   sudo apt install -y \
     build-essential \
     curl wget \
     pkg-config \
     libssl-dev \
     libgtk-3-dev \
     libwebkit2gtk-4.1-dev \
     libjavascriptcoregtk-4.1-dev \
     libsoup-3.0-dev \
     libayatana-appindicator3-dev \
     librsvg2-dev
   ```

2. 安装rust

   ```
   curl https://sh.rustup.rs -sSf | sh   # 按提示装最新版 Rust
   source $HOME/.cargo/env
   ```

3. 进入项目根目录（有 package.json 的地方）

   ```bash
   cd ~/Project
   ```

4. 安装项目依赖（如果还没装过）

   ```bash
   pnpm install
   ```

5. 构建产物

   ```bash
   pnpm run build
   ```

6. 把 pake-cli 当作开发依赖加进来

   ```bash
   pnpm add -D pake-cli
   ```

7. 在 package.json 添加打包脚本（如果没有）

    ```json
    {
      "scripts": {
        "pake-mac": "pake out/index.html --name narratium --use-local-file --icon ./public/icon.icns --multi-arch",
        "pake-win": "pake out/index.html --name narratium --use-local-file --icon ./public/icon.ico",
        "pake-linux": "pake out/index.html --name narratium --use-local-file --icon ./public/icon.png"
      }
    }
    ```

8. 运行打包

    ```bash
    pnpm pake-linux
    pnpm pake-win
    pnpm pake-mac
    ```