---
layout: mypost
title: Pyenv 使用教程
date: 2025-06-28
published: true
categories: 笔记
tags: 
 - linux
---

## 安装

**1. 安装依赖项** 

在安装 `pyenv` 和构建 Python 之前，需要安装一些编译工具和库

```bash
sudo apt update
sudo apt install -y build-essential libssl-dev zlib1g-dev \
libbz2-dev libreadline-dev libsqlite3-dev curl \
libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev
```

**2. 安装 `pyenv`** 

最简单的方法是使用官方的安装脚本

```bash
curl https://pyenv.run | bash
```

**3. 配置 Shell 环境** 

安装脚本会提示你将以下代码添加到 `~/.bashrc`文件中

```bash
# 在文件末尾添加以下三行
export PYENV_ROOT="$HOME/.pyenv"
command -v pyenv >/dev/null || export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init -)"
```

添加后，**重启你的终端**或运行 `source ~/.bashrc` 使配置生效

#### 使用方法

**1. 查看可安装的 Python 版本**

```bash
pyenv install --list
```

**2. 安装指定的 Python 版本** 

例如，安装 Python 3.10.13

```bash
pyenv install 3.10.13
pyenv install 3.11.5
```

这可能需要一些时间，因为它会从源码编译

**3. 查看已安装的版本**

```bash
pyenv versions
# 输出会像这样，* 表示当前激活的版本
  system
* 3.10.13 (set by /home/user/Chat-Share/.python-version)
```

**4. 切换 Python 版本（`pyenv` 的核心功能）**

- **`pyenv global <version>`**: 设置全局默认的 Python 版本

  ```bash
  pyenv global 3.11.5
  python --version  # 会显示 Python 3.11.5
  ```

- **`pyenv local <version>`**: 为当前目录（及其子目录）设置 Python 版本。这是**项目级管理**的杀手级特性

  ```bash
  mkdir my-project && cd my-project
  pyenv local 3.10.3
  # 这会在当前目录创建一个 .python-version 文件
  python --version # 会显示 Python 3.10.13
  cd ..
  python --version # 会变回全局版本 3.11.5
  ```

- **`pyenv shell <version>`**: 仅为当前 shell 会话设置 Python 版本，优先级最高

  ```bash
  pyenv shell 3.11.5
  python --version # 显示 3.11.5
  # 关闭这个终端再打开，版本会恢复
  ```

**5. 配合虚拟环境 (`pyenv-virtualenv`)** 安装 `pyenv-virtualenv` 插件（通常 `pyenv` 安装脚本已包含）

- **创建虚拟环境**

  ```bash
  # pyenv virtualenv <python_version> <environment_name>
  pyenv virtualenv 3.10.13 my-project-env-3.10
  ```

- **激活虚拟环境**

  ```bash
  # 方法一：手动激活
  pyenv activate my-project-env-3.10
  
  # 方法二（推荐）：使用 pyenv local 自动激活
  cd my-project
  pyenv local my-project-env-3.10
  # 之后每次进入这个目录，虚拟环境会自动激活！
  ```